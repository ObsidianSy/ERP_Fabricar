import{r as o,p as R,j as e,C as d,c as n,d as c,e as b,f as r,S as U,g as P,h as z,i as F,k as A,I as H,B as k,w as Q,T as E,x as T,y as h,z as t,D as y,E as a,s as V,P as M,l as G}from"./index-Cc8Dvf1k.js";import{u as J}from"./useFullImportData-CU7LmA3j.js";const $=o.memo(function({initialEnvioNum:m,initialClienteNome:x}){const{selectedClientId:l,setSelectedClientId:C,availableClients:L,isLoadingClients:I}=R(),{envios:g,items:j,pendings:N,summary:i,isLoading:S,loadEnvios:W,loadEnvioDetails:f,loadAllItemsByCliente:D}=J(),[u,_]=o.useState(""),[X,p]=o.useState(""),[w,v]=o.useState(!1);o.useEffect(()=>{x&&!l&&C(x)},[x,l,C]),o.useEffect(()=>{m&&x&&(_(m),p(m),v(!1),setTimeout(()=>{f(x,m)},100))},[m,x,f]);const q=async()=>{l&&(u.trim()?(v(!1),p(u),await f(l,u.trim())):(v(!1),p(""),await D(l)))},B=async s=>{l&&(_(s),v(!1),p(s),await f(l,s))};return j.length,j.reduce((s,K)=>s+K.qtd,0),N.length,e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsx(c,{className:"text-lg",children:"Consultar Envio"}),e.jsx(b,{children:"Busque envios por cliente e número"})]}),e.jsx(r,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Cliente"}),e.jsxs(U,{value:l??"",onValueChange:C,disabled:I,children:[e.jsx(P,{className:"bg-background",children:e.jsx(z,{placeholder:I?"Carregando...":"Selecione um cliente"})}),e.jsx(F,{className:"z-[100] bg-background",children:L.map(s=>e.jsx(A,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Nº Envio ",e.jsx("span",{className:"text-xs text-muted-foreground",children:"(opcional)"})]}),e.jsx(H,{placeholder:"Ex: 53293771 ou deixe vazio para listar todos",value:u,onChange:s=>_(s.target.value),onKeyDown:s=>s.key==="Enter"&&q()})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(k,{onClick:q,disabled:!l||S,className:"w-full",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),u.trim()?"Buscar Envio":"Listar Todos"]})})]})})]}),w&&g.length>0&&e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsx(c,{className:"text-lg",children:"Envios do Cliente"}),e.jsxs(b,{children:[g.length," envio(s) encontrado(s) nos últimos 30 dias"]})]}),e.jsx(r,{children:e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(E,{children:[e.jsx(T,{children:e.jsxs(h,{children:[e.jsx(t,{children:"Nº Envio"}),e.jsx(t,{className:"text-right",children:"Total Itens"}),e.jsx(t,{className:"text-right",children:"Registrados"}),e.jsx(t,{className:"text-right",children:"Pendentes"}),e.jsx(t,{children:"Status"}),e.jsx(t,{className:"text-right",children:"Ação"})]})}),e.jsx(y,{children:g.map(s=>e.jsxs(h,{children:[e.jsx(a,{className:"font-mono font-medium",children:s.envio_num}),e.jsxs(a,{className:"text-right",children:[s.tot_itens," (",s.tot_qtd," un)"]}),e.jsxs(a,{className:"text-right text-green-600",children:[s.registrados_itens," (",s.registrados_qtd," un)"]}),e.jsxs(a,{className:"text-right text-destructive",children:[s.pendentes_itens," (",s.pendentes_qtd," un)"]}),e.jsx(a,{children:e.jsx(V,{variant:s.status==="registrado"?"default":"secondary",children:s.status})}),e.jsx(a,{className:"text-right",children:e.jsx(k,{size:"sm",variant:"outline",onClick:()=>B(s.envio_num),children:"Ver Detalhes"})})]},s.envio_id))})]})})})]}),w&&g.length===0&&!S&&e.jsx(d,{children:e.jsx(r,{className:"py-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Nenhum envio encontrado para este cliente"})})}),!w&&i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(d,{children:[e.jsx(n,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Total Itens"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:i.tot_itens})})]}),e.jsxs(d,{children:[e.jsx(n,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Quantidade"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:i.tot_qtd})})]}),e.jsxs(d,{children:[e.jsx(n,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Registrados"})}),e.jsx(r,{children:e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[i.registrados_itens," (",i.registrados_qtd," un)"]})})]}),e.jsxs(d,{children:[e.jsx(n,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Pendências"})}),e.jsx(r,{children:e.jsxs("div",{className:"text-2xl font-bold text-destructive",children:[i.pendentes_itens," (",i.pendentes_qtd," un)"]})})]})]}),e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Itens Registrados (",j.length,")"]}),e.jsx(b,{children:"SKUs reconhecidos e vendas emitidas"})]}),e.jsx(r,{children:S?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):j.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum item registrado encontrado"}):e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(E,{children:[e.jsx(T,{children:e.jsxs(h,{children:[e.jsx(t,{children:"Linha"}),e.jsx(t,{children:"Código ML"}),e.jsx(t,{children:"SKU Texto"}),e.jsx(t,{children:"SKU Relacionado"}),e.jsx(t,{className:"text-right",children:"Qtd"})]})}),e.jsx(y,{children:j.map(s=>e.jsxs(h,{children:[e.jsx(a,{className:"text-sm text-muted-foreground",children:s.row_num}),e.jsx(a,{className:"font-mono text-sm",children:s.codigo_ml||"—"}),e.jsx(a,{className:"text-sm",children:s.sku_texto}),e.jsx(a,{className:"font-medium",children:s.matched_sku}),e.jsx(a,{className:"text-right",children:s.qtd})]},s.id))})]})})})]}),N.length>0&&e.jsxs(d,{className:"border-destructive/50",children:[e.jsxs(n,{children:[e.jsxs(c,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(G,{className:"h-5 w-5"}),"Pendências de SKU (",N.length,")"]}),e.jsx(b,{children:'SKUs não reconhecidos que precisam ser relacionados na aba "Relacionar Itens"'})]}),e.jsx(r,{children:e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(E,{children:[e.jsx(T,{children:e.jsxs(h,{children:[e.jsx(t,{children:"Linha"}),e.jsx(t,{children:"Código ML"}),e.jsx(t,{children:"SKU Texto"}),e.jsx(t,{className:"text-right",children:"Qtd"})]})}),e.jsx(y,{children:N.map(s=>e.jsxs(h,{children:[e.jsx(a,{className:"text-sm text-muted-foreground",children:s.row_num}),e.jsx(a,{className:"font-mono text-sm",children:s.codigo_ml||"—"}),e.jsx(a,{className:"font-medium",children:s.sku_texto}),e.jsx(a,{className:"text-right",children:s.qtd})]},s.id))})]})})})]})]})]})});export{$ as FullImportedDataTab};
