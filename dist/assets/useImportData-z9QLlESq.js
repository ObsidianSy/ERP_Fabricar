import{r as o,a as I,o as c}from"./index-Cc8Dvf1k.js";const k=()=>{const[d,l]=o.useState([]),[m,i]=o.useState({total:0,relacionados:0,pendentes:0,taxa_match:0}),[p,n]=o.useState(!1),{toast:s}=I(),y=o.useCallback(async(t=1,r=20,a)=>{n(!0);try{const e=await c.getImportRows({clientId:a,status:"pendentes",page:t,pageSize:r});return l(e),e}catch(e){return console.error("Erro ao carregar itens pendentes:",e),s({title:"Erro ao carregar itens",description:"Não foi possível carregar os itens pendentes.",variant:"destructive"}),l([]),[]}finally{n(!1)}},[s]),g=o.useCallback(async(t,r)=>{try{const a=await c.getImportSummary({clientId:t,importId:r,source:"ML"});return i(a),a}catch(a){console.error("Error loading summary:",a);const e={total:0,relacionados:0,pendentes:0,taxa_match:0};return i(e),e}},[]),f=o.useCallback(async t=>{n(!0);try{return await c.getImportRows({...t,source:"ML"})}catch(r){return console.error("Error loading import rows:",r),s({title:"Erro ao carregar dados",description:"Não foi possível carregar os dados importados.",variant:"destructive"}),[]}finally{n(!1)}},[s]),w=o.useCallback(async t=>{n(!0);try{const r=await c.autoRelateAll(t);return s({title:"Auto-relacionamento concluído",description:`Relacionados: ${r.relacionados} / Pendentes: ${r.pendentes}`}),r}catch(r){throw s({title:"Erro no auto-relacionamento",description:"Não foi possível executar o auto-relacionamento.",variant:"destructive"}),r}finally{n(!1)}},[s]),v=o.useCallback(async(t,r,a,e)=>{try{return await c.relateItem({raw_id:t,sku:r,source:e||"manual",learn_alias:!0,alias_text:(a==null?void 0:a.sku_original)||void 0})}catch(u){return console.error("Erro no relacionamento manual:",u),{ok:!1,error:"network_error"}}},[]);return{pendingItems:d,summary:m,isLoading:p,loadPendingItems:y,loadSummary:g,loadImportRows:f,autoRelateAll:w,manualMatch:v}};export{k as u};
